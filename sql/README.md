# 民宿管理系统数据库部署脚本

## 文件说明

本目录包含以下文件：

### 推荐使用（简化版本，避免中文编码问题）：

1. **setup_database_production.bat** - 生产环境数据库创建脚本（MySQL root 密码：root）
2. **setup_database_test.bat** - 测试环境数据库创建脚本（MySQL root 密码：123456）

### 备用版本（包含完整 SQL 语句）：

3. **create_homestay_db_production.bat** - 生产环境完整脚本（MySQL root 密码：root）
4. **create_homestay_db_test.bat** - 测试环境完整脚本（MySQL root 密码：123456）

### 数据文件：

5. **homestay_db.sql** - 原始 SQL 文件（包含完整表结构和数据）

## 使用方法

### 推荐方法（简化版本）

#### 生产环境部署（适用于别人的电脑）

1. 确保 MySQL 8.0+已安装并正在运行
2. 确保 MySQL root 用户密码为：**root**
3. 确保 `homestay_db.sql` 文件在同一目录下
4. 双击运行 `setup_database_production.bat`
5. 等待脚本执行完成

#### 测试环境部署（适用于您的电脑）

1. 确保 MySQL 8.0+已安装并正在运行
2. 确保 MySQL root 用户密码为：**123456**
3. 确保 `homestay_db.sql` 文件在同一目录下
4. 双击运行 `setup_database_test.bat`
5. 等待脚本执行完成

### 备用方法（完整版本）

如果推荐方法遇到问题，可以使用：

- `create_homestay_db_production.bat` （生产环境）
- `create_homestay_db_test.bat` （测试环境）

## 脚本功能

这两个脚本会自动完成以下操作：

1. **检查 MySQL 安装** - 验证 MySQL 是否已安装并在系统 PATH 中
2. **设置字符编码** - 使用 UTF-8 编码防止中文乱码
3. **创建数据库** - 创建名为`homestay_db`的数据库
4. **创建表结构** - 创建以下表：
   - `user` - 用户表
   - `room` - 房间表
   - `room_image` - 房间图片表
   - `orders` - 订单表
5. **插入测试数据** - 插入完整的测试数据
6. **错误处理** - 提供详细的错误信息和解决建议

## 数据库信息

- **数据库名称**: homestay_db
- **字符集**: utf8mb4
- **排序规则**: utf8mb4_unicode_ci
- **MySQL 版本要求**: 8.0+

## 默认管理员账户

创建完成后，系统将包含以下默认管理员账户：

- **用户名**: admin
- **密码**: 123456
- **邮箱**: admin@hms.com
- **电话**: 13800138000

## 故障排除

如果脚本执行失败，请检查：

1. **MySQL 服务状态** - 确保 MySQL 服务正在运行
2. **密码正确性** - 确认 root 用户密码是否正确
3. **权限问题** - 确保 root 用户有创建数据库的权限
4. **端口占用** - 确认 3306 端口未被占用
5. **防火墙设置** - 检查防火墙是否阻止 MySQL 连接

## 注意事项

1. **编码问题** - 脚本已设置`chcp 65001`来处理中文字符显示问题
2. **重复执行** - 脚本可以重复执行，会自动删除已存在的数据库
3. **数据备份** - 执行前请备份重要数据，脚本会删除同名数据库
4. **网络连接** - 确保网络连接正常，某些测试数据包含网络图片链接

## 技术支持

如遇到问题，请检查：

- MySQL 错误日志
- Windows 事件查看器
- 脚本执行过程中的错误提示

---

**创建时间**: 2025-07-16  
**适用版本**: MySQL 8.0+  
**字符编码**: UTF-8
